# 更新日志

## [2026-02-06]

### 优化与改进
- **应用详情页布局优化**:
  - 重构 `AppDashboardView` 元数据展示区域，采用三行分组布局。
  - 优化元数据胶囊（Pill）样式：
    - 自动提取分类前缀作为标签。
    - API 信息（目标/最小 SDK）采用水印风格背景展示，视觉效果更精致。
  - 移动端适配优化，调整间距与字体大小，确保小屏设备下的显示效果。
 - **主题设置界面优化**:
   - 调整后台「系统设置 - 主题」卡片结构，移除多余标题层级，整体观感更简洁。
   - 优化主题颜色选择行布局与颜色块尺寸，在桌面端与移动端下保持更一致的视觉比例。
   - 新增主题预览区域，可实时预览当前主色等配置对页面头部/卡片的影响。
 - **移动端体验优化**:
   - 统一后台主题设置页底部操作按钮在移动端的宽度与对齐方式，避免出现左右不齐或按钮大小不一致的问题。

## [2026-02-05]

### 新增功能
- **音乐下载音质选择**: 支持在搜索结果和歌单详情中选择下载音质（标准 / 高 / 极高 / 无损），并使用新版下载接口配合多级回退策略获取链接。
- **VIP 歌曲标记**: 在音乐搜索结果和歌单详情中为需要付费/VIP 的歌曲显示「VIP」标识，便于区分可直接下载与受限歌曲。

### 优化与改进
- **下载稳定性**:
  - 下载链接获取增加多级接口回退逻辑（download/url/v1 → song/url → song/url/match），显著降低“无法获取下载链接”的情况。
  - 下载失败时增加更明确的错误提示和引导文案，建议检查 API 配置或切换音质等级。
- **移动端适配**:
  - 音乐搜索结果中歌曲标题与「歌手 - 专辑」在移动端统一为单行展示，超出长度使用省略号处理，防止被遮挡或换行错乱。

## [2026-02-03]

### 新增功能
- **音乐批量下载**: 在歌曲列表头部新增批量下载功能，支持多选歌曲进行排队下载
- **跨页选择**: 音乐列表支持跨页保留选中状态，切换分页不丢失已选歌曲

### 优化与改进
- **下载交互**:
  - 优化下载按钮样式为胶囊形，与标题对齐
  - 仅在点击下载按钮后显示复选框列，保持界面整洁
  - 按钮文案更新为"下载"（动态显示选中数量）
- **下载稳定性**:
  - 实现后端代理 (`/api/music-proxy`) 解决跨域下载问题
  - 采用串行下载队列（间隔1.5秒）避免浏览器请求限制

## [2026-02-02]

### 优化与改进
- **图标加载**: 优化应用图标显示逻辑，新增加载失败回退机制与 GitHub 代理支持

## [2026-01-31]

### 优化与改进
- **移动端适配**: 优化移动端整体布局与交互细节
- **音频体验**: 改进私人 FM 和播客页面的使用体验
- **后台 UI**: 调整管理后台界面样式，提升视觉一致性

## [2026-01-30]

### 新增功能
- **反馈管理**:
  - 分离"已接纳"和"已完成"的反馈列表展示
  - 支持后台直接编辑反馈详情
  - 优化反馈为空时的提示样式（使用 Alert 组件）
- **首页分段控制器**: 新增首页/系统分段控制器，支持固定卡片与后台控制卡片切换
- **时间段问候语**: 在首页工具栏左侧添加基于时间的问候语（早上好/下午好/晚上好）
- **移动端标题动画**: 探索页面移动端顶部栏标题支持左右滑动动画效果

### 优化与改进
- **MusicView表格优化**:
  - 移除空列表格列，优化布局空间
  - 对齐分页组件与"歌曲"标题位置
  - 表格顶部显示当前播放列表名称
- **分段控制器交互**:
  - 滚动时自动将分段控制器移动到顶部栏，带平滑动画
  - 统一分段控制器圆角样式，保持尺寸一致性
  - 优化滑块对齐和大小匹配
- **移动端体验**:
  - 当分段控制器在顶部栏显示时，自动隐藏左侧标题
  - 标题显示/隐藏时添加流畅的左右滑动动画
 - 列表页面返回保留滚动位置：启用 KeepAlive 并按路径分离实例（key=route.path）
 - 顶部栏返回按钮统一采用后退行为（router.back），与浏览器返回一致
 - KeepAlive include 覆盖首页/音乐/应用/更新/专题及排行榜、AppCardView
 - 限制缓存实例数为 20，避免过多详情页占用内存

### 修复
- **CSS语法错误**: 修复App.vue中缺失的样式块闭合括号
- **样式冲突**: 解决分段控制器滑块对齐问题

## [2026-01-23]

### 新增功能
- 应用投稿流程分步提交：保存 → 预览 → 最终提交，提供明确指引与状态反馈
- 管理端待审核投稿支持编辑：复用应用列表的编辑表单，仅允许“待审核”状态编辑
- 系统健康检查接口：新增主服务 `/api/v0/charts/rating` 与副服务 `/next-api/apps/devices` 健康检查端点
- 下载增长对比图：新增包名过滤，默认排除“雷速体育” com.leisu.yuan
- 首页音乐卡片移动端适配：显示“打开”入口，胶囊按钮支持自动换行，避免被图片遮挡

### 优化与改进
- 系统状态监控：主服务检测路径改为 `/v0/charts/rating`，提升监控准确性
- 提交页面样式：默认折叠、折叠标题溢出处理（省略展示），整体样式与卡片融合
- 提交表单文案：移除“每5分钟仅可提交一次”提示，由后端频率控制触发提示

### 修复
- 监控页面 404：补充健康检查端点，修复状态描述异常
- 编译错误：移除未使用导入，修复 TS6133
- 后端路由：移除重复的 `app.post('/api/apps')` 定义，避免冲突
- 投稿限制：更新为“10分钟内最多提交 5 次”，仅在超限时提示
- 重复投稿：根据应用名称校验既有收录与待审核投稿，避免重复提交

## [2026-01-22]

### 新增功能
- **系统状态监控页面**: 新增了详细的系统状态监控页面 (`/system-status`)，用于实时监控主 API 和副 API 服务的健康状态。
  - 支持自动刷新（每 30 秒）。
  - 显示响应时间、最后检测时间和详细的状态描述。
  - 即使在 API 异常时也能提供友好的状态提示。
- **系统状态卡片**: 在首页侧边栏添加了系统状态概览卡片，点击可跳转至详细监控页面。

### 优化与改进
- **UI/UX 调整**:
  - 移除了系统状态卡片标题旁边的箭头图标，使界面更简洁。
  - 调整了监控页面中各卡片和标题的间距，提升视觉体验。
  - 优化了“立即检测”按钮的布局，使其在移动端和桌面端都独占一行全宽显示，便于操作。
- **配置更新**:
  - 将“Next API 服务”更名为“副 API 服务”，统一命名规范。
  - 优化了 API 健康检查逻辑，通过代理路径避免跨域问题，提高检测准确性。

### 修复
- 修复了构建过程中因未使用导入 (`Link`) 导致的 TypeScript 编译错误。
